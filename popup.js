function initPopup(){const e=document.getElementById("injectBtn"),n=document.getElementById("licenseKey"),t=document.getElementById("status");function s(e,n){t.textContent=e,t.className=n||""}e&&n&&t?(chrome.storage.local.get(["licenseKey"],(e=>{e.licenseKey&&(n.value=e.licenseKey)})),e.addEventListener("click",(async()=>{const t=n.value.trim();if(t){chrome.storage.local.set({licenseKey:t}),e.disabled=!0,e.innerHTML='<span class="spinner"></span> Injecting...',s("");try{const e=await chrome.runtime.sendMessage({action:"START_INJECTION",licenseKey:t});e&&e.success?s("\u2705 Injection Successful! Reloading...","success"):s(`\u274c Error: ${function(e){if(!e)return"Unknown error";const n=e.toLowerCase();if(n.includes("locked to another device")||n.includes("already used on another device"))return"This license key is already in use on another device.";return e}(e&&e.message)}`,"error")}catch(e){s(`\u274c Communication Error: ${e.message}`,"error")}finally{e.disabled=!1,e.textContent="Inject Cookie"}}else s("Please enter a license key.","error")}))):console.warn("Popup UI elements missing; aborting init.")}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",initPopup):initPopup();